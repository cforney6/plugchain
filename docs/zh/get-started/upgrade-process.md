---
order: 8
---


# 升级操作 

本项目，针对新加入的社区节点和正在运行的社区节点升级的方案和方法进行阐述
## 方案一 逐个版本升级到最新高度

:::warning
当前plugchain版本升级情况 v0.5.0 （块高762880停止出块） -> v0.6.0 -> +++
:::
1. 在线节点方案
```shell
# 升级社区提案生效之后，到升级高度之后，节点停止出来，需要手动升级二进制文件

# 拉取v0.6.0版本代码 （本地可使用 `git tag` 查看下tag版本，如果有 `v0.6.0`,跳过此步骤）
git fetch origin v0.6.0

# 执行编译二进制文件
make install

# 打印版本，确认是否成功
plugchaind version

# 成功之后，kill -9 pid  杀死 plugchaind 原来的进程，然后启动自己的节点，待验证者节点升级量超过2/3时，节点出块
```
2. 新加入节点方案

```shell
# 根据上面提示，新加入的节点，需要先使用v0.5.0版本的二进制文件进行同步区块，达到升级到高度（762880），然后使用v0.6.0的二进制文件进行升级同步最新区块

# 生成指定版本的二进制并编译
git checkout v0.5.0 && make install

# 打印版本查看
plugchaind version

# 然后生成自己的数据目录，配置创世文件和种子信息，进行同步区块
```

待区块达到升级高度（762880），节点会panic死掉，信息如下：

```
ERR UPGRADE "x/token" NEEDED at height: 762880:
2:04AM ERR CONSENSUS FAILURE!!! err="UPGRADE \"x/token\" NEEDED at height: 762880: "
```

需要逐次使用升级的版本进行升级。目前是v0.6.0,如果本地代码没有tag v0.6.0,需要先执行 `git fetch origin v0.6.0` 拉去远程仓库代码，然后执行

```
git checkout v0.6.0 && make install

# 使用v0.6.0版本的二进制文件启动节点进行同步

```



## 方案二 下载升级当前版本的块数据，使用最新二进制文件plugchaind 启动节点

此方案针对新加入节点使用，防止多次升级之后，新加入的节点需要逐级升级达到最新高度


:::warning
目前官方还未提供区块打包数据。后续会完善此升级方案。 TODO
:::

```shell

# 通过官方提供的版本区块数据， 根据自己的需求下载自己需要的版本到节点服务器

# 然后根据下载的区块数据版本，使用升级的下个版本的二进制文件进行初始化节点，然后把数据包解压覆盖数据目录的data目录，然后配置好创世文件和种子信息，启动节点进行同步区块

# 举例 ，官方提供的区块数据版本为v0.6.0升级之前的区块数据
# 1. 需要编译的二进制文件版本为v0.6.0
# 2. 使用v0.6.0版本 初始化节点，配置创世文件和种子信息，然后覆盖data数据目录，启动节点即可。 

```