(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{496:function(t,a,e){"use strict";e.r(a);var s=e(57),o=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"key-management-system"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#key-management-system"}},[t._v("#")]),t._v(" Key Management System")]),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tendermint KMS"),e("OutboundLink")],1),t._v(" is a key management service that allows separating key management from Tendermint nodes. In addition it provides other advantages such as:")]),t._v(" "),e("ul",[e("li",[t._v("Improved security and risk management policies")]),t._v(" "),e("li",[t._v("Unified API and support for various HSM (hardware security modules)")]),t._v(" "),e("li",[t._v("Double signing protection (software or hardware based)")])]),t._v(" "),e("h2",{attrs:{id:"building"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#building"}},[t._v("#")]),t._v(" Building")]),t._v(" "),e("p",[t._v("Detailed build instructions can be found "),e("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms#installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("When compiling the KMS, ensure you have enabled the "),e("code",[t._v("yubihsm")]),t._v(" features:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("cargo "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" tmkms --features"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yubihsm --version"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.10")]),t._v(".0-beta2\n")])])]),e("h2",{attrs:{id:"initialization"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#initialization"}},[t._v("#")]),t._v(" Initialization")]),t._v(" "),e("p",[t._v("Initialize configuration files for Plug Chain Hub")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("tmkms init -n Plug Chain Hub /path/to/kms/home\n")])])]),e("h2",{attrs:{id:"configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[t._v("#")]),t._v(" Configuration")]),t._v(" "),e("p",[t._v("To enable KMS, you need to edit the "),e("code",[t._v("priv_validator_laddr")]),t._v(" in your "),e("code",[t._v("<plugchaind-home>/config/config.toml")]),t._v(" file first. e.g.:")]),t._v(" "),e("div",{staticClass:"language-toml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-toml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TCP or UNIX socket address for Tendermint to listen on for")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# connections from an external PrivValidator process")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key property"}},[t._v("priv_validator_laddr")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost:26658"')]),t._v("\n")])])]),e("p",[t._v("Then, downLoad [priv_validator_state.json example](https://github.com/Plug Chain/Plug Chain Hub/blob/master/docs/tools/priv_validator_state.json) and modify all field values to match your "),e("code",[t._v("<plugchaind-home>/data/priv_validator_state.json")]),t._v(" values.")]),t._v(" "),e("p",[t._v("Next, you just need to edit the configuration file "),e("code",[t._v("/path/to/kms/home/tmkms.toml")]),t._v(" as follows:")]),t._v(" "),e("ul",[e("li",[t._v("Configure "),e("code",[t._v("state_file")]),t._v(" as the "),e("code",[t._v("priv_validator_state.json")]),t._v(" completed in the previous step.")]),t._v(" "),e("li",[t._v("Write your Yubihsm password to file "),e("code",[t._v("yubihsm-password.txt")]),t._v(" and configure "),e("code",[t._v("password_file")]),t._v(" as it.")]),t._v(" "),e("li",[t._v("Edit "),e("code",[t._v("addr")]),t._v(" to point to your "),e("code",[t._v("plugchaind")]),t._v(" instance(note: no need to specify the connection id, just like tcp://localhost:26658).")]),t._v(" "),e("li",[t._v("Adjust "),e("code",[t._v("chain_id")]),t._v(" to match your "),e("code",[t._v("<plugchaind-home>/config/genesis.json")]),t._v(" settings.")]),t._v(" "),e("li",[t._v("Edit "),e("code",[t._v("auth")]),t._v(" to authorize access to your Yubihsm.")]),t._v(" "),e("li",[t._v("Edit "),e("code",[t._v("keys")]),t._v(" to determine which pubkey you will be using.")]),t._v(" "),e("li",[t._v("Edit "),e("code",[t._v("protocol_version")]),t._v(" to v0.34.")])]),t._v(" "),e("p",[t._v("Then start tmkms:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("tmkms start -c /path/to/kms/home/tmkms.toml\n")])])]),e("h3",{attrs:{id:"using-a-yubihsm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-a-yubihsm"}},[t._v("#")]),t._v(" Using a YubiHSM")]),t._v(" "),e("p",[t._v("Detailed information on how to setup a KMS with YubiHSM2 can be found "),e("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms/blob/master/README.yubihsm.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("If you want to import an existing Plug Chain Hub private_key:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("tmkms yubihsm keys "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("plug_home"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/config/priv_validator.json -i "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" -t json -c /path/to/kms/home/tmkms.toml\n")])])])])}),[],!1,null,null,null);a.default=o.exports}}]);