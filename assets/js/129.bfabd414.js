(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{559:function(t,a,s){"use strict";s.r(a);var e=s(57),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kms-密钥管理系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kms-密钥管理系统"}},[t._v("#")]),t._v(" KMS - 密钥管理系统")]),t._v(" "),s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tendermint KMS"),s("OutboundLink")],1),t._v("是一个密钥管理服务，可将密钥管理与Tendermint节点分开。此外它还具有其他优势，例如：")]),t._v(" "),s("ul",[s("li",[t._v("提高安全和风险管理策略")]),t._v(" "),s("li",[t._v("统一的API和对各种HSM（硬件安全模块）的支持")]),t._v(" "),s("li",[t._v("双签保护（基于软件或硬件）")])]),t._v(" "),s("h2",{attrs:{id:"构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[t._v("#")]),t._v(" 构建")]),t._v(" "),s("p",[t._v("可以在"),s("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms#installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("找到详细的构建说明")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("在编译KMS的时候，确保已启用"),s("code",[t._v("yubihsm")]),t._v("功能：")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("cargo "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" tmkms --features"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yubihsm --version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.10")]),t._v(".0-beta2\n")])])]),s("h2",{attrs:{id:"初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[t._v("#")]),t._v(" 初始化")]),t._v(" "),s("p",[t._v("为Plug Chain Hub初始化配置文件")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("tmkms init -n Plug Chain Hub /path/to/kms/home\n")])])]),s("h2",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("p",[t._v("如果要启用KMS，首先需要在"),s("code",[t._v("<plugchaind-home>/config/config.toml")]),t._v("文件中编辑"),s("code",[t._v("priv_validator_laddr")]),t._v("。例如：")]),t._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TCP or UNIX socket address for Tendermint to listen on for")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# connections from an external PrivValidator process")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[t._v("priv_validator_laddr")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost:26658"')]),t._v("\n")])])]),s("p",[t._v("然后，你需要下载[priv_validator_state.json示例](https://github.com/Plug Chain/Plug Chain Hub/blob/master/docs/tools/priv_validator_state.json)并按照"),s("code",[t._v("<plugchaind-home>/data/priv_validator_state.json")]),t._v("修改所有字段值。")]),t._v(" "),s("p",[t._v("接下来，你只要只需要按如下方式编辑配置文件"),s("code",[t._v("/path/to/kms/home/tmkms.toml")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("配置"),s("code",[t._v("state_file")]),t._v("为上一步完成的"),s("code",[t._v("priv_validator_state.json")]),t._v("。")]),t._v(" "),s("li",[t._v("将你的Yubihsm密码写入文件"),s("code",[t._v("yubihsm-password.txt")]),t._v("并将"),s("code",[t._v("password_file")]),t._v("设置为它。")]),t._v(" "),s("li",[t._v("编辑"),s("code",[t._v("addr")]),t._v("指向你的"),s("code",[t._v("plugchaind")]),t._v("实例（注意：无需指定连接ID，仅让它保持格式如：tcp://localhost:26658）。")]),t._v(" "),s("li",[t._v("调整"),s("code",[t._v("chain_id")]),t._v(" 以匹配你的"),s("code",[t._v("<plugchaind-home>/config/genesis.json")]),t._v("中的设置。")]),t._v(" "),s("li",[t._v("编辑"),s("code",[t._v("auth")]),t._v("以授权访问你的Yubihsm。")]),t._v(" "),s("li",[t._v("编辑"),s("code",[t._v("keys")]),t._v("确定你将使用的pubkey。")]),t._v(" "),s("li",[t._v("编辑"),s("code",[t._v("protocol_version")]),t._v("为v0.34。")])]),t._v(" "),s("p",[t._v("然后启动 tmkms")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("tmkms start -c /path/to/kms/home/tmkms.toml\n")])])]),s("h3",{attrs:{id:"使用yubihsm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用yubihsm"}},[t._v("#")]),t._v(" 使用YubiHSM")]),t._v(" "),s("p",[t._v("有关如何使用YubiHSM2设置KMS的更多信息，请参阅"),s("a",{attrs:{href:"https://github.com/iqlusioninc/tmkms/blob/master/README.yubihsm.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("如果要导入已存在的Plug Chain Hub private_key，可以：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("tmkms yubihsm keys "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("plug_home"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/config/priv_validator.json -i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" -t json -c /path/to/kms/home/tmkms.toml\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);